# OnceCell & OnceLock

## OnceCell\<T>

- `OnceCell<T>`在某种程度上是`Cell`和`RefCell`的混合体，用于那些通常只需要设置一次的值
- 可以在不移动或复制内部值的情况下获得一个引用`&T`
- 同时也不需要运行时检查
- 一旦设置后，它的值就不能再被更新
    - 除非你对`OnceCell`本身有一个可变引用

**主要方法**

- `get`: 获取内部值的引用
- `set`: 在值尚未设置时进行 设置(返回一个Result)
- `get_or_init`: 返回内部值，如果需要进行初始化
- `get_mut`: 提供内部值的可变引用
    - 但只有当你对`OnceCell`本身持有一个可变引用时才能使用

## OnceLock\<T>

- 一种同步原语，只能被写入一次
- 是线程安全的`OnceCell`，可以在`static`中使用
- 用于线程安全的、一次性的变量初始化，并且可以根据调用者使用不同的初始化函数